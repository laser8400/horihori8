<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ¡ãƒªã‚«éƒ½å¸‚é…ç½®ã‚¯ã‚¤ã‚º</title>
    <style>
        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 {
            margin-bottom: 10px;
            font-size: 24px;
            color: #2c3e50;
        }

        #game-container {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            padding: 20px;
            text-align: center;
        }

        #status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 18px;
        }

        #question-area {
            font-size: 22px;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #e8f4fd;
            border-radius: 8px;
            border-left: 5px solid #3498db;
        }

        .highlight {
            color: #e74c3c;
            font-weight: bold;
            font-size: 26px;
        }

        /* Map Styles */
        #map-wrapper {
            position: relative;
            width: 100%;
            padding-bottom: 60%; /* Aspect ratio for the map */
            background-color: #b3ddf2; /* Ocean color */
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #ddd;
        }

        #usa-map {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .land {
            fill: #fdfdfd;
            stroke: #aaa;
            stroke-width: 1;
        }

        .city-point {
            fill: #34495e;
            stroke: white;
            stroke-width: 2px;
            cursor: pointer;
            transition: all 0.2s ease;
            r: 8px; /* Radius of the dot */
        }

        .city-point:hover {
            fill: #f39c12;
            r: 10px;
        }

        /* Animation classes */
        .correct-anim {
            fill: #27ae60 !important;
            r: 12px !important;
        }

        .wrong-anim {
            fill: #c0392b !important;
        }

        /* Overlay & Modals */
        #message-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
        }

        #message-overlay.visible {
            visibility: visible;
            opacity: 1;
        }

        .btn {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .btn:hover {
            background-color: #2980b9;
        }

        #result-screen {
            display: none;
        }

    </style>
</head>
<body>

    <h1>ğŸ‡ºğŸ‡¸ ã‚¢ãƒ¡ãƒªã‚«ä¸»è¦éƒ½å¸‚é…ç½®ã‚¯ã‚¤ã‚º</h1>

    <div id="game-container">
        <div id="start-screen">
            <p>åœ°å›³ä¸Šã®ç‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€éƒ½å¸‚ã®å ´æ‰€ã‚’å½“ã¦ã¦ãã ã•ã„ã€‚</p>
            <button class="btn" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>

        <div id="game-play" style="display: none;">
            <div id="status-bar">
                <span id="progress-text">ç¬¬ 1 / 10 å•</span>
                <span id="score-text">ã‚¹ã‚³ã‚¢: 0</span>
            </div>

            <div id="question-area">
                <span class="highlight" id="target-city">New York</span> ã¯ã©ã“ï¼Ÿ
            </div>

            <div id="map-wrapper">
                <svg id="usa-map" viewBox="0 0 960 600" preserveAspectRatio="xMidYMid slice">
                    <path class="land" d="M936,211 L958,185 L916,155 L926,128 L897,117 L879,88 L892,72 L863,55 L844,66 L828,66 L812,85 L764,96 L748,93 L729,114 L716,108 L697,125 L652,117 L627,133 L607,117 L595,122 L582,108 L582,88 L540,66 L498,69 L486,50 L421,50 L411,28 L373,28 L360,50 L318,50 L279,53 L241,47 L196,47 L190,66 L180,61 L167,77 L151,69 L125,77 L116,47 L80,55 L80,83 L51,83 L26,99 L16,133 L26,177 L13,205 L16,246 L39,266 L39,282 L55,296 L61,318 L93,332 L116,366 L151,366 L186,346 L206,357 L215,382 L267,382 L292,407 L308,402 L308,449 L360,466 L395,496 L414,529 L443,535 L456,562 L482,571 L498,540 L514,546 L552,540 L568,521 L604,521 L627,504 L646,504 L662,490 L681,490 L675,471 L700,457 L710,432 L736,441 L748,421 L742,407 L768,394 L771,366 L758,355 L784,335 L777,321 L806,310 L806,291 L832,282 L825,260 L857,249 L854,233 L883,219 L899,222 L936,211 Z" />
                    
                    <g id="cities-layer"></g>
                </svg>

                <div id="message-overlay">
                    <div id="feedback-text"></div>
                    <button class="btn" id="next-btn" onclick="nextQuestion()">æ¬¡ã¸</button>
                </div>
            </div>
        </div>

        <div id="result-screen">
            <h2>çµæœç™ºè¡¨</h2>
            <p id="final-score" style="font-size: 28px; font-weight: bold; color: #2c3e50;">0 / 10</p>
            <p id="comment"></p>
            <button class="btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦éŠã¶</button>
        </div>
    </div>

    <script>
        // City Data: Coordinates based on the SVG viewBox (960x600)
        // Adjustments made to fit the simplified map path roughly
        const cities = [
            { id: 1, name: "ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯", x: 860, y: 150 },
            { id: 2, name: "ãƒ­ã‚µãƒ³ã‚¼ãƒ«ã‚¹", x: 80, y: 320 },
            { id: 3, name: "ã‚·ã‚«ã‚´", x: 630, y: 170 },
            { id: 4, name: "ãƒ’ãƒ¥ãƒ¼ã‚¹ãƒˆãƒ³", x: 500, y: 480 },
            { id: 5, name: "ã‚·ã‚¢ãƒˆãƒ«", x: 100, y: 40 },
            { id: 6, name: "ãƒã‚¤ã‚¢ãƒŸ", x: 800, y: 530 },
            { id: 7, name: "ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³", x: 40, y: 250 },
            { id: 8, name: "ãƒ‡ãƒ³ãƒãƒ¼", x: 340, y: 260 },
            { id: 9, name: "ãƒ©ã‚¹ãƒ™ã‚¬ã‚¹", x: 130, y: 290 },
            { id: 10, name: "ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ¼ãƒªãƒ³ã‚º", x: 600, y: 480 },
            { id: 11, name: "ãƒœã‚¹ãƒˆãƒ³", x: 900, y: 120 },
            { id: 12, name: "ã‚¢ãƒˆãƒ©ãƒ³ã‚¿", x: 700, y: 380 },
            { id: 13, name: "ãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C.", x: 810, y: 210 },
            { id: 14, name: "ãƒ€ãƒ©ã‚¹", x: 480, y: 420 },
            { id: 15, name: "ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹", x: 190, y: 350 }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let targetCity = null;
        let availableCities = [];
        let questionOrder = [];

        // Setup the game
        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-play').style.display = 'block';
            
            // Randomly select 10 questions
            questionOrder = [...cities].sort(() => 0.5 - Math.random()).slice(0, 10);
            
            // Draw all cities on the map
            renderCities();
            
            currentQuestionIndex = 0;
            score = 0;
            updateUI();
        }

        function renderCities() {
            const layer = document.getElementById('cities-layer');
            layer.innerHTML = ''; // Clear existing

            cities.forEach(city => {
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute("cx", city.x);
                circle.setAttribute("cy", city.y);
                circle.setAttribute("r", 8); // Default radius
                circle.setAttribute("class", "city-point");
                circle.setAttribute("data-id", city.id);
                circle.onclick = (e) => handleCityClick(e, city);
                layer.appendChild(circle);
            });
        }

        function updateUI() {
            if (currentQuestionIndex >= questionOrder.length) {
                endGame();
                return;
            }

            targetCity = questionOrder[currentQuestionIndex];
            
            document.getElementById('progress-text').textContent = `ç¬¬ ${currentQuestionIndex + 1} / ${questionOrder.length} å•`;
            document.getElementById('score-text').textContent = `ã‚¹ã‚³ã‚¢: ${score}`;
            document.getElementById('target-city').textContent = targetCity.name;
            
            // Reset overlay
            const overlay = document.getElementById('message-overlay');
            overlay.classList.remove('visible');
            
            // Reset dots styles
            document.querySelectorAll('.city-point').forEach(dot => {
                dot.classList.remove('correct-anim', 'wrong-anim');
                dot.style.pointerEvents = 'auto'; // Enable clicks
            });
        }

        function handleCityClick(event, selectedCity) {
            // Disable all clicks
            document.querySelectorAll('.city-point').forEach(dot => {
                dot.style.pointerEvents = 'none';
            });

            const clickedDot = event.target;
            const overlay = document.getElementById('message-overlay');
            const feedbackText = document.getElementById('feedback-text');
            const nextBtn = document.getElementById('next-btn');

            let isCorrect = (selectedCity.id === targetCity.id);

            if (isCorrect) {
                score++;
                clickedDot.classList.add('correct-anim');
                feedbackText.textContent = "æ­£è§£ï¼ â­•ï¸";
                feedbackText.style.color = "#27ae60";
            } else {
                clickedDot.classList.add('wrong-anim');
                
                // Highlight the actual correct answer
                const correctDot = document.querySelector(`.city-point[data-id="${targetCity.id}"]`);
                if(correctDot) correctDot.classList.add('correct-anim');

                feedbackText.textContent = `æ®‹å¿µ... æ­£è§£ã¯ã€Œ${targetCity.name}ã€ã§ã—ãŸ`;
                feedbackText.style.color = "#c0392b";
            }

            // Show overlay
            if (currentQuestionIndex === questionOrder.length - 1) {
                nextBtn.textContent = "çµæœã‚’è¦‹ã‚‹";
            } else {
                nextBtn.textContent = "æ¬¡ã¸";
            }
            overlay.classList.add('visible');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            updateUI();
        }

        function endGame() {
            document.getElementById('game-play').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            
            const finalScoreElement = document.getElementById('final-score');
            finalScoreElement.textContent = `${score} / ${questionOrder.length} å•æ­£è§£`;
            
            const commentElement = document.getElementById('comment');
            if (score === 10) {
                commentElement.textContent = "å®Œç’§ã§ã™ï¼ã‚¢ãƒ¡ãƒªã‚«åœ°ç†ãƒã‚¹ã‚¿ãƒ¼ã§ã™ã­ï¼ğŸ†";
            } else if (score >= 7) {
                commentElement.textContent = "ç´ æ™´ã‚‰ã—ã„ï¼ã‹ãªã‚Šè©³ã—ã„ã§ã™ã­ã€‚ğŸ‘";
            } else if (score >= 4) {
                commentElement.textContent = "ã¾ãšã¾ãšã®çµæœã§ã™ã€‚ğŸ‘";
            } else {
                commentElement.textContent = "ã‚‚ã†å°‘ã—å‹‰å¼·ã—ã¾ã—ã‚‡ã†... ğŸ“š";
            }
        }
    </script>
</body>
</html>
