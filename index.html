<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ¡ãƒªã‚«ä¸»è¦éƒ½å¸‚ã‚¯ã‚¤ã‚ºï¼ˆé«˜ç²¾åº¦ç‰ˆï¼‰</title>
    <style>
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
        }

        h1 { margin: 10px 0; font-size: 24px; color: #2c3e50; }

        #game-container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 15px;
            text-align: center;
            position: relative;
        }

        #status-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: bold;
            font-size: 16px;
            color: #555;
        }

        #question-area {
            font-size: 20px;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 6px;
            border-left: 5px solid #2980b9;
        }

        .highlight { color: #c0392b; font-weight: bold; font-size: 24px; }

        /* Map Styles */
        #map-wrapper {
            position: relative;
            width: 100%;
            /* ViewBox is 960x600, so roughly 62.5% padding for responsiveness */
            padding-bottom: 62.5%; 
            background-color: #aed6f1; /* Ocean */
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #bdc3c7;
        }

        #usa-map {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.15));
        }

        .state {
            fill: #fdfdfd;
            stroke: #bdc3c7; /* State borders */
            stroke-width: 1;
            stroke-linejoin: round;
        }

        /* Hover effect on states just for visual feedback */
        .state:hover {
            fill: #f0f3f4;
        }

        .city-point {
            fill: #34495e;
            stroke: white;
            stroke-width: 2px;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            r: 7px;
        }

        .city-point:hover {
            fill: #f39c12;
            r: 9px; 
            z-index: 100;
        }

        /* Animation classes */
        .correct-anim { fill: #27ae60 !important; r: 10px !important; stroke: #fff; }
        .wrong-anim { fill: #c0392b !important; }
        .correct-anim-faded { fill: #27ae60 !important; opacity: 0.5; }

        /* Overlay */
        #message-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 22px;
            font-weight: bold;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.2s;
            backdrop-filter: blur(2px);
        }
        #message-overlay.visible { visibility: visible; opacity: 1; }

        .btn {
            margin-top: 15px;
            padding: 10px 25px;
            background-color: #2980b9;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .btn:hover { background-color: #1abc9c; }

        #result-screen { display: none; margin-top: 20px;}
    </style>
</head>
<body>

    <h1>ğŸ‡ºğŸ‡¸ ã‚¢ãƒ¡ãƒªã‚«ä¸»è¦éƒ½å¸‚ã‚¯ã‚¤ã‚º</h1>

    <div id="game-container">
        <div id="start-screen">
            <p>å·å¢ƒå…¥ã‚Šã®åœ°å›³ã§ã€éƒ½å¸‚ã®æ­£ç¢ºãªä½ç½®ã‚’å½“ã¦ã¦ãã ã•ã„ã€‚</p>
            <button class="btn" onclick="startGame()">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>

        <div id="game-play" style="display: none;">
            <div id="status-bar">
                <span id="progress-text">ç¬¬ 1 / 10 å•</span>
                <span id="score-text">ã‚¹ã‚³ã‚¢: 0</span>
            </div>

            <div id="question-area">
                <span class="highlight" id="target-city">New York</span> ã¯ã©ã“ï¼Ÿ
            </div>

            <div id="map-wrapper">
                <svg id="usa-map" viewBox="0 0 960 600">
                    <g id="states-layer">
                        <path class="state" d="M225.8,405.3l-2.6-4.5l0.4-1.2l-1.3-1.6l0.8-2.3l-12.7-27.1l-61.9-24.3l-12.1,30.3l-8.5,3.6l-3.3,13.2l0.2,4.8l26.9,13.6l10.8-2.6l12.4,14.6l18.4,0.1l7.3-1.8L225.8,405.3z" id="AZ"/><path class="state" d="M149.3,376.1l12.1-30.3l-22.3-13.6l-46.7,11.3L89,348l1.3,7.5l9.1,5.2l7.7,1.8l6.1,6.5l8.6,4.6L149.3,376.1z" id="CA-S"/><path class="state" d="M89,348l3.4-4.5l-32.9-88l-40.4,16.6l14.4,49.8l5.2,8.6l7.7,5.5l9,1.7l14.7,6.3L89,348z" id="CA"/><path class="state" d="M223.2,400.8l2.6,4.5l-25.2,14.8l3.6,56.9l68.7,0l2.3-59l-42.9,0l-0.7-19.3L223.2,400.8z" id="NM"/><path class="state" d="M200.6,420.1l25.2-14.8l30.8,55.5l1.6,26.7l21.4,12.7l17.7,29.9l19.9,10.2l12.8,22.2l-8.6,12.5l-12.6-1.5l-11.5,5.1l-10.3,11l-3.8,11.4l-11.4,2.5l-12.1-7.2l-27-21.6l-19.5-23.7l-4.2-22.5l-3.6-56.9L200.6,420.1z" id="TX"/><path class="state" d="M830.5,510.9l-11.3-2.6l-20.9-18.7l-4.5-8.5l-19.1-1.2l-25.3,0.3l-2.4,26.8l8,10.6l15,36.5l12.1,20.5l9.2,3.3l6.5-5.9l-2.9-10.4l-6.5-18.5l2.4-12.2l11.4-18.9l15.1-9.9l10.9-2.9L830.5,510.9z" id="FL"/><path class="state" d="M161.4,345.8l22.3,13.6l60.2-21.7l-3.6-76l-50.5-2.2L147.2,316l2.3,27.9L161.4,345.8z" id="NV"/><path class="state" d="M244,337.7l-60.2,21.7l12.7,27.1l26.6-17.2l8.4-3.1l0.7,19.3l42.9,0l2.5-44.5L244,337.7z" id="CO"/><path class="state" d="M190,259.5l50.5,2.2l2.3-43.9l-42.6-6.4l-12.2,28.6L190,259.5z" id="UT"/><path class="state" d="M59.5,255.5l32.9,88l2-6.5l25-117.8l-15.3-4.1L95.5,202L55.9,219L59.5,255.5z" id="OR"/><path class="state" d="M104.1,215.1l-8.6,13l15.3,4.1l20.8-97.7l-65.7-18.3l-5.6,8.6l-0.9,13l11.6,21.8l3.1,17.4l14.8,25.3L104.1,215.1z" id="WA"/><path class="state" d="M119.4,228.2L94.4,346l46.7-11.3l6.3-75.2L131.6,215L119.4,228.2z" id="ID"/><path class="state" d="M331.1,192.5l-88.3,6.3l-2.3,43.9l3.6,76l33.1-3.6l-2-45.7l54.8-5.3L331.1,192.5z" id="WY"/><path class="state" d="M242.8,198.8l88.3-6.3l-5.3-60.2l-114.7,14.7l12.2,46.8L242.8,198.8z" id="MT"/><path class="state" d="M439,363.8l-5.8-51.2l-51.5,4.7l-1.8,47.9l59.1,1.1V363.8z" id="MO"/><path class="state" d="M381.7,317.3l51.5-4.7l-4.1-41.9l-50.6,0.9L381.7,317.3z" id="IA"/><path class="state" d="M570.6,275l-40.4,1.8l-10.3,5.9l-4.1,23l4.7,59.3l15.5,5.2l20.9-19.1l11.4-32.9L570.6,275z" id="OH"/><path class="state" d="M378.5,271.6l50.6-0.9l-4.1-49.8l-60.2,3.8L378.5,271.6z" id="MN"/><path class="state" d="M364.8,224.7l60.2-3.8l-2.7-32.2l-96.6,11.3l5.3,60.2l-1.2,55.1l48.7-0.4L364.8,224.7z" id="ND_SD"/><path class="state" d="M425,188.7l2.7,32.2l4.1,49.8l4.1,41.9l51.9,4.2l-4-50.5l-8.6-3.8l-1.6-9.7l6.5-12.8l12.4-31.1l-10.4-1.6l-10.4,6.8l-10.4-14.7l-16-1.1L425,188.7z" id="WI"/><path class="state" d="M487.8,316.8l-51.9-4.2l5.8,51.2l2.3,19.3l15.3,13.8l21.6-11.8l10.3,2.7l0.7-72.2L487.8,316.8z" id="IL"/><path class="state" d="M492.3,315.6l-0.7,72.2l12.4,5.4l24.5-3.4l1.8-68L492.3,315.6z" id="IN"/><path class="state" d="M579.5,257.6l-8.9,17.4l40.4-1.8l38.2-22.1l-14.4-42.9l-22.1,12.2l-21.4,12.5l-6.8,11.3L579.5,257.6z" id="PA"/><path class="state" d="M729,190.4l-14.2,20.8l5.2,16.7l-9.5,4.5l-3.8-10.6l-11.5,1.1l-3.8,11.5l25,56l17.7-18.7l5.2-13.8l23.5-18.9l-3.6-25.2l-10.6-13.3L729,190.4z" id="NY"/><path class="state" d="M848,105l-19.4,4.1l-0.9,12.4l-11.1,1.1l-3.8,13.1l-17.1,3.4l1.1,12.6l10.1,6.8l-1.8,5.4l11.9,14.6l5.2-14.9l24.1-13.5l14.9-35.4L848,105z" id="NE"/><path class="state" d="M259,475.6l-2.3-59l-2.5,44.5l65.2-6.5l2.9,64.3l-26.6-4.5l-12.8,10.6l-6.1-4.7L259,475.6z" id="OK"/><path class="state" d="M322.3,454.6l-2.9-64.3l-48.7,0.4l5.4,62.8L322.3,454.6z" id="KS"/><path class="state" d="M276.1,390.7l48.7-0.4l1.2-55.1l-54.8,5.3l2,45.7L276.1,390.7z" id="NEB"/><path class="state" d="M570,361.2l-21.4,24.3l-45.7-4.1l-12.8,14.9l12.4,32l53.5-6.1l6.8-11.7l16.4-1.8L570,361.2z" id="NC"/><path class="state" d="M608.2,306.4l-16.7,11.5l-20.9,19.1l-15.5-5.2l-4.7-59.3l15.1-6.5l30.6,25.9L608.2,306.4z" id="WV"/><path class="state" d="M649,307.3l-38.2,22.1l16.7-11.5l-11.9,25.5l9.5,17.8l-16.4,1.8l20,35.3l16.7-10.8l10.1-26.8l14.4-39.6L649,307.3z" id="VA"/><path class="state" d="M502.8,422.4l45.7,4.1l21.4-24.3l9.5,17.8l-13.5,37.3l-10.4,0.7l-4.5,14.2l-20.7-1.1L502.8,422.4z" id="TN"/><path class="state" d="M439,363.8l2.3,19.3l17.8-3.4l20.5,3.6l4.5,41.9l-22.1,2.7l-3.8,17.1l-17.1,1.1l-5.6-11l-34.9,10.6l-5.4-62.8l46.1-4.1L439,363.8z" id="AR"/><path class="state" d="M410.6,446.6l34.9-10.6l5.6,11l-3.2,35.8l6.3,9.5l-6.8,5.4l-11.3,1.4l-7-8.1l-16.9,8.3l-2.7-8.1l-15.8,1.4l-1.6-26.7l14.9-15.3L410.6,446.6z" id="LA"/><path class="state" d="M510,482.3l21.6-11.1l4.5-14.2l10.4-0.7l13.5-37.3l2.7,21.8l28.6,8.6l-14.9,50.8l-40.9,0.2L510,482.3z" id="MS_AL"/><path class="state" d="M591.3,449.4l-28.6-8.6l-2.7-21.8l13.1,2.5l29.9-5.2l-12.8,40.5l14.4,26.1l-8,10.6l-19.1-1.2l-1.1-15.5L591.3,449.4z" id="GA"/><path class="state" d="M573,421.3l29.9-5.2l-13.1-2.5l16.4-1.8l-9.5-17.8l13.1-36.2l18.4,5.4l-13.3,37.8l-2.3,18.5L573,421.3z" id="SC"/><path fill="none" stroke="#7f8c8d" stroke-width="1.5" d="M104,215 l-65,18 l14,-49 l40,-16 l32,88 l25,-117 l114,-14 l5,60 l88,6 l54,5 l1,-55 l-5,-60 l96,-11 l2,32 l-60,3 l4,49 l-50,0 l40,1 l8,-17 l6,-11 l21,-12 l22,-12 l14,42 l-38,22 l40,-1 l10,-5 l4,-23 l11,32 l2,30 l-6,11 l-53,6 l-12,-32 l12,-14 l45,4 l21,-24 l9,17 l-16,1 l13,2 l-29,5 l12,37 l2,18 l13,-37 l18,-5 l-13,-36 l20,-35 l16,-1 l-9,-17 l11,-25 l-16,11 l38,-22 l18,17 l10,13 l3,25 l-23,18 l-5,13 l-17,18 l-25,-56 l3,-11 l11,-1 l3,10 l9,-4 l-5,-16 l14,-20 l54,19 l-14,35 l-24,13 l-5,14 l-11,-14 l1,5 l-10,-6 l-1,-12 l17,-3 l3,-13 l11,-1 l0,-12 l19,-4 l16,35 l-34,80 l-10,2 l-15,9 l-11,18 l-2,12 l6,18 l2,10 l-6,5 l-9,-3 l-12,-20 l-15,-36 l-8,-10 l2,-26 l25,0 l19,1 l4,8 l20,18 l11,2 l14,-34 l-11,-28 l-40,0 l14,-50 l-28,-8 l-2,-21 l-13,37 l-10,0 l-4,14 l-21,11 l26,16 l1,15 l19,1 l8,-10 l-14,-26 l12,-40 l-29,5 l-13,-2 l2,21 l28,8 l26,76 l-14,0 l-12,31 l-14,1 l-10,5 l-11,3 l-12,-3 l-17,-3 l-12,7 l-11,-2 l-3,-11 l-10,-11 l-11,-5 l-12,1 l-8,-12 l-12,-22 l-19,-10 l-17,-29 l-21,-12 l-1,-26 l-30,-55 l-25,14 l-27,51 l-7,1 l-18,0 l-12,-14 l-10,2 l-26,-13 l0,-4 l3,-13 l8,-3 l12,-30 l61,24 l12,27 l25,-44 l-12,-30 l-60,-21 l-14,-29 l-2,-27 l14,-29 l50,2 l3,76 l-60,21 l-22,-13 l-14,28 l-8,-4 l-6,-6 l-7,-1 l-9,-5 l-1,-7 z" />
                    </g>
                    
                    <g id="cities-layer"></g>
                </svg>

                <div id="message-overlay">
                    <div id="feedback-text"></div>
                    <button class="btn" id="next-btn" onclick="nextQuestion()">æ¬¡ã¸</button>
                </div>
            </div>
        </div>

        <div id="result-screen">
            <h2>çµæœç™ºè¡¨</h2>
            <p id="final-score" style="font-size: 28px; font-weight: bold; color: #2c3e50;">0 / 10</p>
            <p id="comment"></p>
            <button class="btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦éŠã¶</button>
        </div>
    </div>

    <script>
        // City Data: Coordinates calibrated for the Albers USA ViewBox (960x600)
        // These are much more accurate relative to the state borders provided.
        const cities = [
            { id: 1, name: "ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯", x: 795, y: 195 },
            { id: 2, name: "ãƒ­ã‚µãƒ³ã‚¼ãƒ«ã‚¹", x: 95, y: 355 },
            { id: 3, name: "ã‚·ã‚«ã‚´", x: 575, y: 220 },
            { id: 4, name: "ãƒ’ãƒ¥ãƒ¼ã‚¹ãƒˆãƒ³", x: 445, y: 460 },
            { id: 5, name: "ã‚·ã‚¢ãƒˆãƒ«", x: 105, y: 60 },
            { id: 6, name: "ãƒã‚¤ã‚¢ãƒŸ", x: 760, y: 535 },
            { id: 7, name: "ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³", x: 55, y: 290 },
            { id: 8, name: "ãƒ‡ãƒ³ãƒãƒ¼", x: 300, y: 290 },
            { id: 9, name: "ãƒ©ã‚¹ãƒ™ã‚¬ã‚¹", x: 155, y: 310 },
            { id: 10, name: "ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ¼ãƒªãƒ³ã‚º", x: 535, y: 465 },
            { id: 11, name: "ãƒœã‚¹ãƒˆãƒ³", x: 840, y: 165 },
            { id: 12, name: "ã‚¢ãƒˆãƒ©ãƒ³ã‚¿", x: 630, y: 405 },
            { id: 13, name: "ãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C.", x: 730, y: 260 },
            { id: 14, name: "ãƒ€ãƒ©ã‚¹", x: 435, y: 405 },
            { id: 15, name: "ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹", x: 190, y: 380 },
            { id: 16, name: "ãƒ‡ãƒˆãƒ­ã‚¤ãƒˆ", x: 620, y: 205 },
            { id: 17, name: "ãƒŸãƒã‚¢ãƒãƒªã‚¹", x: 500, y: 165 },
            { id: 18, name: "ã‚»ãƒ³ãƒˆãƒ«ã‚¤ã‚¹", x: 540, y: 305 },
            { id: 19, name: "ãƒ•ã‚£ãƒ©ãƒ‡ãƒ«ãƒ•ã‚£ã‚¢", x: 780, y: 225 },
            { id: 20, name: "ã‚ªãƒ¼ãƒ©ãƒ³ãƒ‰", x: 745, y: 500 }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let targetCity = null;
        let questionOrder = [];

        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-play').style.display = 'block';
            
            // Randomly select 10 questions
            questionOrder = [...cities].sort(() => 0.5 - Math.random()).slice(0, 10);
            
            renderCities();
            currentQuestionIndex = 0;
            score = 0;
            updateUI();
        }

        function renderCities() {
            const layer = document.getElementById('cities-layer');
            layer.innerHTML = ''; 

            cities.forEach(city => {
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute("cx", city.x);
                circle.setAttribute("cy", city.y);
                circle.setAttribute("class", "city-point");
                circle.setAttribute("data-id", city.id);
                // Add title for native tooltip if user hovers long enough (optional hint)
                // circle.setAttribute("title", "???"); 
                circle.onclick = (e) => handleCityClick(e, city);
                layer.appendChild(circle);
            });
        }

        function updateUI() {
            if (currentQuestionIndex >= questionOrder.length) {
                endGame();
                return;
            }

            targetCity = questionOrder[currentQuestionIndex];
            
            document.getElementById('progress-text').textContent = `ç¬¬ ${currentQuestionIndex + 1} / ${questionOrder.length} å•`;
            document.getElementById('score-text').textContent = `ã‚¹ã‚³ã‚¢: ${score}`;
            document.getElementById('target-city').textContent = targetCity.name;
            
            const overlay = document.getElementById('message-overlay');
            overlay.classList.remove('visible');
            
            document.querySelectorAll('.city-point').forEach(dot => {
                dot.classList.remove('correct-anim', 'wrong-anim', 'correct-anim-faded');
                dot.style.pointerEvents = 'auto';
            });
        }

        function handleCityClick(event, selectedCity) {
            document.querySelectorAll('.city-point').forEach(dot => {
                dot.style.pointerEvents = 'none';
            });

            const clickedDot = event.target;
            const overlay = document.getElementById('message-overlay');
            const feedbackText = document.getElementById('feedback-text');
            const nextBtn = document.getElementById('next-btn');

            let isCorrect = (selectedCity.id === targetCity.id);

            if (isCorrect) {
                score++;
                clickedDot.classList.add('correct-anim');
                feedbackText.innerHTML = `<span style="color:#27ae60; font-size:40px;">â­•ï¸</span><br>æ­£è§£ï¼`;
            } else {
                clickedDot.classList.add('wrong-anim');
                
                // Highlight the actual correct answer
                const correctDot = document.querySelector(`.city-point[data-id="${targetCity.id}"]`);
                if(correctDot) correctDot.classList.add('correct-anim-faded');

                feedbackText.innerHTML = `<span style="color:#c0392b; font-size:40px;">âœ–</span><br>æ­£è§£ã¯ã€Œ${targetCity.name}ã€ã§ã—ãŸ`;
            }

            if (currentQuestionIndex === questionOrder.length - 1) {
                nextBtn.textContent = "çµæœã‚’è¦‹ã‚‹";
            } else {
                nextBtn.textContent = "æ¬¡ã¸";
            }
            overlay.classList.add('visible');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            updateUI();
        }

        function endGame() {
            document.getElementById('game-play').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            
            const finalScoreElement = document.getElementById('final-score');
            finalScoreElement.textContent = `${score} / ${questionOrder.length} å•æ­£è§£`;
            
            const commentElement = document.getElementById('comment');
            if (score === 10) {
                commentElement.textContent = "å®Œç’§ï¼ã‚¢ãƒ¡ãƒªã‚«ã®åœ°ç†ã¯ãƒãƒƒãƒãƒªã§ã™ã­ï¼ğŸ†";
            } else if (score >= 8) {
                commentElement.textContent = "ç´ æ™´ã‚‰ã—ã„ï¼ã»ã¨ã‚“ã©æ­£è§£ã§ã™ã€‚ğŸ‡ºğŸ‡¸";
            } else if (score >= 5) {
                commentElement.textContent = "ã¾ãšã¾ãšã®çµæœã§ã™ã€‚å·ã®ä½ç½®ã‚’è¦šãˆã‚‹ã¨ã•ã‚‰ã«ä¼¸ã³ã¾ã™ï¼";
            } else {
                commentElement.textContent = "ãƒ‰ãƒ³ãƒã‚¤ï¼åœ°å›³ã‚’ã‚ˆãè¦‹ã¦å†æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†ã€‚";
            }
        }
    </script>
</body>
</html>
